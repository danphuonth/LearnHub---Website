<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Dashboard - LearnHub</title>
    <link rel="stylesheet" href="../css/style.css">
    
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-storage-compat.js"></script>
</head>
<body>
    <!-- HEADER -->
    <header class="header">
        <nav class="nav-container">
            <div class="logo" onclick="window.location.href='home.html'">
                <span style="color: #dc3545;">‚öôÔ∏è</span> LearnHub Admin
            </div>
            <ul class="nav-menu">
                <li><a class="nav-link" href="index.html">V·ªÅ Trang Ch·ªß</a></li>
            </ul>
            <div class="nav-actions" id="navActions">
                <span class="btn btn-secondary" onclick="showLoginModal()">ƒêƒÉng Nh·∫≠p</span>
            </div>
        </nav>
    </header>

    <!-- ADMIN DASHBOARD -->
    <section class="admin-section">
        <div class="admin-container">
            <!-- SIDEBAR -->
            <aside class="admin-sidebar">
                <div class="admin-menu">
                    <h3>üìä QU·∫¢N TR·ªä</h3>
                    <a href="#" class="admin-menu-item active" onclick="showAdminTab('dashboard'); return false;">
                        <span>üìà</span> T·ªïng Quan
                    </a>
                    <a href="#" class="admin-menu-item" onclick="showAdminTab('users'); return false;">
                        <span>üë•</span> Qu·∫£n L√Ω H·ªçc Vi√™n
                    </a>
                    <a href="#" class="admin-menu-item" onclick="showAdminTab('courses'); return false;">
                        <span>üìö</span> Qu·∫£n L√Ω Kh√≥a H·ªçc
                    </a>
                    <a href="#" class="admin-menu-item" onclick="showAdminTab('enrollments'); return false;">
                        <span>üìù</span> ƒêƒÉng K√Ω Kh√≥a H·ªçc
                    </a>
                    <a href="#" class="admin-menu-item" onclick="showAdminTab('teachers'); return false;">
                        <span>üë®‚Äçüè´</span> Qu·∫£n L√Ω Gi·∫£ng Vi√™n
                    </a>
                    <a href="#" class="admin-menu-item" onclick="showAdminTab('analytics'); return false;">
                        <span>üìä</span> Th·ªëng K√™
                    </a>
                    <a href="#" class="admin-menu-item" onclick="showAdminTab('settings'); return false;">
                        <span>‚öôÔ∏è</span> C√†i ƒê·∫∑t
                    </a>
                </div>
            </aside>

            <!-- MAIN CONTENT -->
            <main class="admin-main">
                <!-- DASHBOARD TAB -->
                <div id="admin-tab-dashboard" class="admin-tab active">
                    <div class="admin-header">
                        <h1>T·ªïng Quan H·ªá Th·ªëng</h1>
                        <p>Ch√†o m·ª´ng tr·ªü l·∫°i, <span id="adminName">Admin</span>!</p>
                    </div>

                    <!-- STATISTICS CARDS -->
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-icon" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
                                üë•
                            </div>
                            <div class="stat-info">
                                <h3 id="totalUsers">0</h3>
                                <p>T·ªïng H·ªçc Vi√™n</p>
                                <span class="stat-change positive">+12% th√°ng n√†y</span>
                            </div>
                        </div>

                        <div class="stat-card">
                            <div class="stat-icon" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);">
                                üìö
                            </div>
                            <div class="stat-info">
                                <h3 id="totalCourses">0</h3>
                                <p>T·ªïng Kh√≥a H·ªçc</p>
                                <span class="stat-change positive">+5 kh√≥a m·ªõi</span>
                            </div>
                        </div>

                        <div class="stat-card">
                            <div class="stat-icon" style="background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);">
                                üìù
                            </div>
                            <div class="stat-info">
                                <h3 id="totalEnrollments">0</h3>
                                <p>L∆∞·ª£t ƒêƒÉng K√Ω</p>
                                <span class="stat-change positive">+25% th√°ng n√†y</span>
                            </div>
                        </div>

                        <div class="stat-card">
                            <div class="stat-icon" style="background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);">
                                üí∞
                            </div>
                            <div class="stat-info">
                                <h3 id="totalRevenue">0ƒë</h3>
                                <p>Doanh Thu</p>
                                <span class="stat-change positive">+18% th√°ng n√†y</span>
                            </div>
                        </div>
                    </div>

                    <!-- RECENT ACTIVITIES -->
                    <div class="admin-card">
                        <h3>Ho·∫°t ƒê·ªông G·∫ßn ƒê√¢y</h3>
                        <div id="recentActivities" class="activities-list">
                            <p class="loading-text">ƒêang t·∫£i...</p>
                        </div>
                    </div>
                </div>

                <!-- USERS TAB -->
                <div id="admin-tab-users" class="admin-tab">
                    <div class="admin-header">
                        <h1>Qu·∫£n L√Ω H·ªçc Vi√™n</h1>
                        <div class="header-actions">
                            <input type="text" placeholder="T√¨m ki·∫øm h·ªçc vi√™n..." class="search-input" id="searchUsers" onkeyup="searchUsers()">
                            <button class="btn btn-primary" onclick="exportUsers()">üì• Xu·∫•t Excel</button>
                        </div>
                    </div>

                    <div class="admin-card">
                        <div class="table-header">
                            <h3>Danh S√°ch H·ªçc Vi√™n (<span id="usersCount">0</span>)</h3>
                            <select class="filter-select" id="roleFilter" onchange="filterUsersByRole()">
                                <option value="">T·∫•t c·∫£ vai tr√≤</option>
                                <option value="student">H·ªçc vi√™n</option>
                                <option value="teacher">Gi·∫£ng vi√™n</option>
                                <option value="admin">Admin</option>
                            </select>
                        </div>

                        <div class="table-responsive">
                            <table class="admin-table">
                                <thead>
                                    <tr>
                                        <th>Avatar</th>
                                        <th>H·ªç T√™n</th>
                                        <th>Email</th>
                                        <th>Vai Tr√≤</th>
                                        <th>S·ªë Kh√≥a H·ªçc</th>
                                        <th>Ng√†y ƒêƒÉng K√Ω</th>
                                        <th>Tr·∫°ng Th√°i</th>
                                        <th>Thao T√°c</th>
                                    </tr>
                                </thead>
                                <tbody id="usersTableBody">
                                    <tr>
                                        <td colspan="8" class="loading-text">ƒêang t·∫£i d·ªØ li·ªáu...</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>

                        <div class="table-pagination">
                            <button class="btn btn-secondary" onclick="prevUsersPage()">‚Üê Tr∆∞·ªõc</button>
                            <span>Trang <span id="currentUsersPage">1</span></span>
                            <button class="btn btn-secondary" onclick="nextUsersPage()">Sau ‚Üí</button>
                        </div>
                    </div>
                </div>

                <!-- COURSES TAB -->
                <div id="admin-tab-courses" class="admin-tab">
                    <div class="admin-header">
                        <h1>Qu·∫£n L√Ω Kh√≥a H·ªçc</h1>
                        <div class="header-actions">
                            <input type="text" placeholder="T√¨m ki·∫øm kh√≥a h·ªçc..." class="search-input" id="searchCourses">
                            <button class="btn btn-primary" onclick="showAddCourseModal()">‚ûï Th√™m Kh√≥a H·ªçc</button>
                        </div>
                    </div>

                    <div class="courses-grid-admin">
                        <div id="coursesListAdmin">
                            <p class="loading-text">ƒêang t·∫£i kh√≥a h·ªçc...</p>
                        </div>
                    </div>
                </div>

                <!-- ENROLLMENTS TAB -->
                <div id="admin-tab-enrollments" class="admin-tab">
                    <div class="admin-header">
                        <h1>Qu·∫£n L√Ω ƒêƒÉng K√Ω Kh√≥a H·ªçc</h1>
                        <div class="header-actions">
                            <input type="text" placeholder="T√¨m ki·∫øm..." class="search-input" id="searchEnrollments">
                            <select class="filter-select" id="courseFilter" onchange="filterEnrollments()">
                                <option value="">T·∫•t c·∫£ kh√≥a h·ªçc</option>
                            </select>
                        </div>
                    </div>

                    <div class="admin-card">
                        <div class="table-header">
                            <h3>Danh S√°ch ƒêƒÉng K√Ω (<span id="enrollmentsCount">0</span>)</h3>
                            <button class="btn btn-secondary" onclick="exportEnrollments()">üì• Xu·∫•t Excel</button>
                        </div>

                        <div class="table-responsive">
                            <table class="admin-table">
                                <thead>
                                    <tr>
                                        <th>H·ªçc Vi√™n</th>
                                        <th>Email</th>
                                        <th>Kh√≥a H·ªçc</th>
                                        <th>Gi√°</th>
                                        <th>Ti·∫øn ƒê·ªô</th>
                                        <th>Ng√†y ƒêƒÉng K√Ω</th>
                                        <th>Tr·∫°ng Th√°i</th>
                                        <th>Thao T√°c</th>
                                    </tr>
                                </thead>
                                <tbody id="enrollmentsTableBody">
                                    <tr>
                                        <td colspan="8" class="loading-text">ƒêang t·∫£i d·ªØ li·ªáu...</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- TEACHERS TAB -->
                <div id="admin-tab-teachers" class="admin-tab">
                    <div class="admin-header">
                        <h1>Qu·∫£n L√Ω Gi·∫£ng Vi√™n</h1>
                        <button class="btn btn-primary" onclick="showAddTeacherModal()">‚ûï Th√™m Gi·∫£ng Vi√™n</button>
                    </div>

                    <div class="teachers-grid">
                        <div id="teachersList">
                            <p class="loading-text">ƒêang t·∫£i gi·∫£ng vi√™n...</p>
                        </div>
                    </div>
                </div>

                <!-- ANALYTICS TAB -->
                <div id="admin-tab-analytics" class="admin-tab">
                    <div class="admin-header">
                        <h1>Th·ªëng K√™ & B√°o C√°o</h1>
                        <select class="filter-select">
                            <option>7 ng√†y qua</option>
                            <option>30 ng√†y qua</option>
                            <option>3 th√°ng qua</option>
                            <option>1 nƒÉm qua</option>
                        </select>
                    </div>

                    <div class="analytics-grid">
                        <div class="admin-card">
                            <h3>Xu H∆∞·ªõng ƒêƒÉng K√Ω</h3>
                            <canvas id="enrollmentChart" width="400" height="200"></canvas>
                        </div>

                        <div class="admin-card">
                            <h3>Kh√≥a H·ªçc Ph·ªï Bi·∫øn</h3>
                            <div id="popularCourses">
                                <p class="loading-text">ƒêang t·∫£i...</p>
                            </div>
                        </div>

                        <div class="admin-card">
                            <h3>Doanh Thu Theo Th√°ng</h3>
                            <canvas id="revenueChart" width="400" height="200"></canvas>
                        </div>

                        <div class="admin-card">
                            <h3>T·ª∑ L·ªá Ho√†n Th√†nh</h3>
                            <div id="completionRates">
                                <p class="loading-text">ƒêang t·∫£i...</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- SETTINGS TAB -->
                <div id="admin-tab-settings" class="admin-tab">
                    <div class="admin-header">
                        <h1>C√†i ƒê·∫∑t H·ªá Th·ªëng</h1>
                    </div>

                    <div class="admin-card">
                        <h3>C√†i ƒê·∫∑t Chung</h3>
                        <form id="systemSettingsForm">
                            <div class="form-group">
                                <label class="form-label">T√™n Website</label>
                                <input type="text" class="form-input" value="LearnHub">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Email H·ªó Tr·ª£</label>
                                <input type="email" class="form-input" value="info@learnhub.vn">
                            </div>
                            <div class="form-group">
                                <label class="form-label">S·ªë ƒêi·ªán Tho·∫°i</label>
                                <input type="tel" class="form-input" value="1900-1234">
                            </div>
                            <button type="submit" class="btn btn-primary">L∆∞u Thay ƒê·ªïi</button>
                        </form>
                    </div>

                    <div class="admin-card">
                        <h3>Ph√¢n Quy·ªÅn</h3>
                        <div class="permissions-list">
                            <div class="permission-item">
                                <strong>Qu·∫£n l√Ω h·ªçc vi√™n</strong>
                                <label class="switch">
                                    <input type="checkbox" checked>
                                    <span class="slider"></span>
                                </label>
                            </div>
                            <div class="permission-item">
                                <strong>Qu·∫£n l√Ω kh√≥a h·ªçc</strong>
                                <label class="switch">
                                    <input type="checkbox" checked>
                                    <span class="slider"></span>
                                </label>
                            </div>
                            <div class="permission-item">
                                <strong>Xem th·ªëng k√™</strong>
                                <label class="switch">
                                    <input type="checkbox" checked>
                                    <span class="slider"></span>
                                </label>
                            </div>
                        </div>
                    </div>
                </div>
            </main>
        </div>
    </section>

    <!-- USER DETAIL MODAL -->
    <div id="userDetailModal" class="modal">
        <div class="modal-content modal-large">
            <button class="modal-close" onclick="closeModal('userDetailModal')">&times;</button>
            <h2 class="modal-title">Chi Ti·∫øt H·ªçc Vi√™n</h2>
            
            <div class="user-detail-content">
                <div class="user-detail-header">
                    <img id="userDetailAvatar" src="" alt="Avatar" class="user-detail-avatar">
                    <div>
                        <h3 id="userDetailName"></h3>
                        <p id="userDetailEmail"></p>
                        <span id="userDetailRole" class="badge"></span>
                    </div>
                </div>

                <div class="user-detail-tabs">
                    <button class="tab-btn active" onclick="showUserDetailTab('info')">Th√¥ng Tin</button>
                    <button class="tab-btn" onclick="showUserDetailTab('courses')">Kh√≥a H·ªçc</button>
                    <button class="tab-btn" onclick="showUserDetailTab('activity')">Ho·∫°t ƒê·ªông</button>
                </div>

                <div id="userDetailTabContent">
                    <!-- Content will be loaded dynamically -->
                </div>

                <div class="modal-actions">
                    <button class="btn btn-danger" onclick="banUser()">üö´ Kh√≥a T√†i Kho·∫£n</button>
                    <button class="btn btn-secondary" onclick="changeUserRole()">üîÑ ƒê·ªïi Vai Tr√≤</button>
                    <button class="btn btn-primary" onclick="closeModal('userDetailModal')">ƒê√≥ng</button>
                </div>
            </div>
        </div>
    </div>

    <!-- ADD COURSE MODAL -->
    <div id="addCourseModal" class="modal">
        <div class="modal-content">
            <button class="modal-close" onclick="closeModal('addCourseModal')">&times;</button>
            <h2 class="modal-title">Th√™m Kh√≥a H·ªçc M·ªõi</h2>
            
            <form id="addCourseForm" onsubmit="addCourse(event)">
                <div class="form-group">
                    <label class="form-label">T√™n Kh√≥a H·ªçc</label>
                    <input type="text" class="form-input" required>
                </div>
                <div class="form-group">
                    <label class="form-label">Danh M·ª•c</label>
                    <select class="form-input" required>
                        <option value="">Ch·ªçn danh m·ª•c</option>
                        <option value="web">Web Development</option>
                        <option value="mobile">Mobile App</option>
                        <option value="ai">AI & ML</option>
                        <option value="design">UI/UX Design</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label">Gi√° (VNƒê)</label>
                    <input type="number" class="form-input" required>
                </div>
                <div class="form-group">
                    <label class="form-label">M√¥ T·∫£</label>
                    <textarea class="form-input" rows="4" required></textarea>
                </div>
                <button type="submit" class="btn btn-primary" style="width: 100%;">Th√™m Kh√≥a H·ªçc</button>
            </form>
        </div>
    </div>

    <!-- Firebase Config -->
    <script src="../js/firebase-config.js"></script>
    <script src="../js/admin.js"></script>
</body>
</html>